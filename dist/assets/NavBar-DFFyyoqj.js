import{r,j as e,L as l}from"./index-cMq4sX42.js";import{A as m}from"./constants-C9Jc7q6O.js";const P=t=>{const[a,o]=r.useState(null);return r.useEffect(()=>{(async()=>{try{if(!t)return;const c=await fetch(`${m}/user/preferences`,{headers:{Authorization:`Bearer ${t}`}});if(!c.ok)throw new Error("Failed to fetch user preferences");const u=await c.json();o(u.preferences)}catch(c){console.error("Error fetching user preferences:",c)}})()},[t]),a},L=()=>{const[t,a]=r.useState([]),[o,d]=r.useState([]),[c,u]=r.useState([]),[x,v]=r.useState([]),[w,b]=r.useState(!0),[j,g]=r.useState(!0),y=localStorage.getItem("authToken"),f=P(y),N=s=>{const{name:n,checked:p}=s.target,i=s.target.value;n==="sport"?a(p?[...t,i]:t.filter(h=>h!==i)):n==="team"&&d(p?[...o,i]:o.filter(h=>h!==i))},S=async()=>{try{if(!(await fetch(`${m}/user/preferences`,{method:"PATCH",headers:{"Content-Type":"application/json",Authorization:`Bearer ${y}`},body:JSON.stringify({preferences:{selectedSports:t,selectedTeams:o}})})).ok)throw new Error("Failed to update preferences");let n=JSON.parse(localStorage.getItem("userData")||"{}");localStorage.setItem("userData",JSON.stringify({...n,preferences:{selectedSports:t,selectedTeams:o}})),n=JSON.parse(localStorage.getItem("userData")||"{}"),b(!1),g(!1)}catch(s){console.error("Error updating preferences:",s),g(!1)}};r.useEffect(()=>{f&&(a(f.selectedSports||[]),d(f.selectedTeams||[]))},[f]),r.useEffect(()=>{(async()=>{try{const n=await fetch(`${m}/sports`),p=await n.json();u(p.sports);const i=await fetch(`${m}/teams`),h=await i.json();if(v(h),!n.ok||!i.ok)throw new Error("Failed to fetch data");g(!1)}catch(n){console.error("Error fetching data:",n),g(!1)}})()},[f]);const k=()=>{b(!1)};return e.jsx(e.Fragment,{children:w&&e.jsx("div",{className:"fixed top-0 left-0 w-full h-full flex items-center justify-center bg-black bg-opacity-50 z-50",children:e.jsxs("div",{className:"bg-gray-200 text-lg rounded-lg overflow-hidden shadow-xl w-112 max-h-full overflow-y-auto",children:[e.jsxs("div",{className:"p-6",children:[e.jsx("h2",{className:"text-2xl font-bold mb-4",children:"Select Favourites"}),e.jsx("hr",{className:"border border-black m-1"}),e.jsxs("div",{className:"mb-3 grid grid-cols-3 gap-4",children:[e.jsx("h3",{className:"font-bold mb-2 col-span-3 underline",children:"Sports"}),j&&e.jsx("p",{children:"Loading..."}),c.slice(0,12).map(s=>e.jsxs("label",{className:"block",children:[e.jsx("input",{type:"checkbox",name:"sport",value:s.name,checked:t.includes(s.name),onChange:N,className:"mr-2"}),s.name]},s.id))]}),e.jsxs("div",{className:"grid grid-cols-3 gap-3",children:[e.jsx("h3",{className:"font-bold mb-2 col-span-3 underline",children:"Teams"}),j&&e.jsx("p",{children:"Loading..."}),x.slice(0,12).map(s=>e.jsxs("label",{className:"block",children:[e.jsx("input",{type:"checkbox",name:"team",value:s.name,checked:o.includes(s.name),onChange:N,className:"mr-2"}),s.name]},s.id))]})]}),e.jsxs("div",{className:"flex justify-end px-6 pb-6",children:[e.jsx("button",{onClick:S,className:"bg-blue-500 text-white px-4 py-2 font-semibold rounded-md mr-2 hover:bg-blue-700 focus:outline-none focus:ring focus:border-blue-300",children:"Save Preferences"}),e.jsx("button",{onClick:k,className:"bg-gray-300 text-gray-800 px-4 py-2 font-semibold rounded-md hover:bg-gray-400 focus:outline-none focus:ring focus:border-gray-300",children:"Close"})]})]})})})},E=()=>{const[t,a]=r.useState(!1);return r.useEffect(()=>{const o=localStorage.getItem("authToken");a(!!o)},[]),t},O=()=>{const[t,a]=r.useState(!1),[o,d]=r.useState(!1),c=E(),u=()=>{a(!t)},x=()=>{d(!o)};return e.jsxs("nav",{className:"bg-gray-800 px-2 py-2",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("div",{className:"flex flex-wrap justify-center items-center",children:e.jsx(l,{to:"/",className:"flex items-center text-white text-3xl font-bold px-2",children:"Sports Live"})}),e.jsxs("div",{className:"flex flex-wrap space-x-4 text-white text-lg items-center",children:[c&&e.jsx("button",{onClick:x,className:"text-white hover:bg-gray-700 px-3 py-2 rounded-md focus:outline-none group-hover:bg-gray-700",children:"Preferences"}),e.jsx(l,{to:"/home",children:"Home"}),e.jsx(l,{to:"/articles",children:"Articles"}),e.jsx(l,{to:"/matches",children:"Matches"}),e.jsx(l,{to:"/teams",children:"Teams"}),c?e.jsxs("div",{className:"relative inline-block group",tabIndex:0,children:[e.jsx("button",{onClick:u,onBlur:()=>a(!1),className:`text-white hover:bg-gray-700 px-3 py-2 rounded-md focus:outline-none group-hover:bg-gray-700 ${t?"focus:ring focus:ring-gray-400":""}`,children:e.jsx("span",{children:"âŒ”"})}),e.jsx("div",{className:`origin-top-right absolute right-0 mt-2 w-48 rounded-md shadow-lg bg-white ring-1 ring-black ring-opacity-5 focus:outline-none transition-all duration-300 ${t?"opacity-100 scale-100":"opacity-0 scale-95"}`,children:e.jsxs("div",{className:"py-1 font-semibold",children:[e.jsx(l,{to:"/user",className:"block px-4 py-2 text-sm text-gray-700 hover:bg-gray-100",children:"My Profile"}),e.jsx("hr",{}),e.jsx(l,{to:"/logout",className:"block px-4 py-2 text-sm text-gray-700 hover:bg-gray-100 focus:outline-none",children:"Logout"})]})})]}):e.jsxs(e.Fragment,{children:[e.jsx(l,{to:"/signup",className:"text-white hover:bg-gray-700 px-3 py-2 rounded-md focus:outline-none group-hover:bg-gray-700",children:"Sign Up"}),e.jsx(l,{to:"/signin",className:"text-white hover:bg-gray-700 px-3 py-2 rounded-md focus:outline-none group-hover:bg-gray-700",children:"Sign In"})]})]})]}),o&&e.jsx(L,{})]})};export{O as N,E as a,P as u};
