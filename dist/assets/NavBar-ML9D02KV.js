var R=Object.defineProperty;var z=(s,e,t)=>e in s?R(s,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):s[e]=t;var P=(s,e,t)=>z(s,typeof e!="symbol"?e+"":e,t);import{r as c,g as U,c as D,A as I,j as n,L as y}from"./index-CHljlE-R.js";function J(){if(console&&console.warn){for(var s=arguments.length,e=new Array(s),t=0;t<s;t++)e[t]=arguments[t];v(e[0])&&(e[0]=`react-i18next:: ${e[0]}`),console.warn(...e)}}const O={};function T(){for(var s=arguments.length,e=new Array(s),t=0;t<s;t++)e[t]=arguments[t];v(e[0])&&O[e[0]]||(v(e[0])&&(O[e[0]]=new Date),J(...e))}const A=(s,e)=>()=>{if(s.isInitialized)e();else{const t=()=>{setTimeout(()=>{s.off("initialized",t)},0),e()};s.on("initialized",t)}},$=(s,e,t)=>{s.loadNamespaces(e,A(s,t))},M=(s,e,t,i)=>{v(t)&&(t=[t]),t.forEach(u=>{s.options.ns.indexOf(u)<0&&s.options.ns.push(u)}),s.loadLanguages(e,A(s,i))},B=function(s,e){let t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};const i=e.languages[0],u=e.options?e.options.fallbackLng:!1,a=e.languages[e.languages.length-1];if(i.toLowerCase()==="cimode")return!0;const l=(N,x)=>{const r=e.services.backendConnector.state[`${N}|${x}`];return r===-1||r===2};return t.bindI18n&&t.bindI18n.indexOf("languageChanging")>-1&&e.services.backendConnector.backend&&e.isLanguageChangingTo&&!l(e.isLanguageChangingTo,s)?!1:!!(e.hasResourceBundle(i,s)||!e.services.backendConnector.backend||e.options.resources&&!e.options.partialBundledLanguages||l(i,s)&&(!u||l(a,s)))},H=function(s,e){let t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};return!e.languages||!e.languages.length?(T("i18n.languages were undefined or empty",e.languages),!0):e.options.ignoreJSONStructure!==void 0?e.hasLoadedNamespace(s,{lng:t.lng,precheck:(u,a)=>{if(t.bindI18n&&t.bindI18n.indexOf("languageChanging")>-1&&u.services.backendConnector.backend&&u.isLanguageChangingTo&&!a(u.isLanguageChangingTo,s))return!1}}):B(s,e,t)},v=s=>typeof s=="string",G=s=>typeof s=="object"&&s!==null,W=c.createContext();class Y{constructor(){P(this,"getUsedNamespaces",()=>Object.keys(this.usedNamespaces));this.usedNamespaces={}}addUsedNamespaces(e){e.forEach(t=>{this.usedNamespaces[t]||(this.usedNamespaces[t]=!0)})}}const q=(s,e)=>{const t=c.useRef();return c.useEffect(()=>{t.current=s},[s,e]),t.current},F=(s,e,t,i)=>s.getFixedT(e,t,i),K=(s,e,t,i)=>c.useCallback(F(s,e,t,i),[s,e,t,i]),E=function(s){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const{i18n:t}=e,{i18n:i,defaultNS:u}=c.useContext(W)||{},a=t||i||D();if(a&&!a.reportNamespaces&&(a.reportNamespaces=new Y),!a){T("You will need to pass in an i18next instance by using initReactI18next");const g=(h,b)=>v(b)?b:G(b)&&v(b.defaultValue)?b.defaultValue:Array.isArray(h)?h[h.length-1]:h,f=[g,{},!1];return f.t=g,f.i18n={},f.ready=!1,f}a.options.react&&a.options.react.wait!==void 0&&T("It seems you are still using the old wait option, you may migrate to the new useSuspense behaviour.");const l={...U(),...a.options.react,...e},{useSuspense:N,keyPrefix:x}=l;let r=u||a.options&&a.options.defaultNS;r=v(r)?[r]:r||["translation"],a.reportNamespaces.addUsedNamespaces&&a.reportNamespaces.addUsedNamespaces(r);const d=(a.isInitialized||a.initializedStoreOnce)&&r.every(g=>H(g,a,l)),k=K(a,e.lng||null,l.nsMode==="fallback"?r:r[0],x),C=()=>k,m=()=>F(a,e.lng||null,l.nsMode==="fallback"?r:r[0],x),[j,w]=c.useState(C);let S=r.join();e.lng&&(S=`${e.lng}${S}`);const L=q(S),o=c.useRef(!0);c.useEffect(()=>{const{bindI18n:g,bindI18nStore:f}=l;o.current=!0,!d&&!N&&(e.lng?M(a,e.lng,r,()=>{o.current&&w(m)}):$(a,r,()=>{o.current&&w(m)})),d&&L&&L!==S&&o.current&&w(m);const h=()=>{o.current&&w(m)};return g&&a&&a.on(g,h),f&&a&&a.store.on(f,h),()=>{o.current=!1,g&&a&&g.split(" ").forEach(b=>a.off(b,h)),f&&a&&f.split(" ").forEach(b=>a.store.off(b,h))}},[a,S]),c.useEffect(()=>{o.current&&d&&w(C)},[a,x,d]);const p=[j,a,d];if(p.t=j,p.i18n=a,p.ready=d,d||!d&&!N)return p;throw new Promise(g=>{e.lng?M(a,e.lng,r,()=>g()):$(a,r,()=>g())})},Q=s=>{const[e,t]=c.useState(null);return c.useEffect(()=>{(async()=>{try{if(!s)return;const u=await fetch(`${I}/user/preferences`,{headers:{Authorization:`Bearer ${s}`}});if(!u.ok)throw new Error("Failed to fetch user preferences");const a=await u.json();t(a.preferences)}catch(u){console.error("Error fetching user preferences:",u)}})()},[s]),e},X=()=>{const[s,e]=c.useState([]),[t,i]=c.useState([]),[u,a]=c.useState([]),[l,N]=c.useState([]),[x,r]=c.useState(!0),[d,k]=c.useState(!0),C=localStorage.getItem("authToken"),m=Q(C),{t:j}=E(),w=o=>{const{name:p,checked:g}=o.target,f=o.target.value;p==="sport"?e(g?[...s,f]:s.filter(h=>h!==f)):p==="team"&&i(g?[...t,f]:t.filter(h=>h!==f))},S=async()=>{try{if(!(await fetch(`${I}/user/preferences`,{method:"PATCH",headers:{"Content-Type":"application/json",Authorization:`Bearer ${C}`},body:JSON.stringify({preferences:{selectedSports:s,selectedTeams:t}})})).ok)throw new Error("Failed to update preferences");let p=JSON.parse(localStorage.getItem("userData")||"{}");localStorage.setItem("userData",JSON.stringify({...p,preferences:{selectedSports:s,selectedTeams:t}})),p=JSON.parse(localStorage.getItem("userData")||"{}"),r(!1),k(!1)}catch(o){console.error("Error updating preferences:",o),k(!1)}};c.useEffect(()=>{m&&(e(m.selectedSports||[]),i(m.selectedTeams||[]))},[m]),c.useEffect(()=>{(async()=>{try{const p=await fetch(`${I}/sports`),g=await p.json();a(g.sports);const f=await fetch(`${I}/teams`),h=await f.json();if(N(h),!p.ok||!f.ok)throw new Error("Failed to fetch data");k(!1)}catch(p){console.error("Error fetching data:",p),k(!1)}})()},[m]);const L=()=>{r(!1)};return n.jsx(n.Fragment,{children:x&&n.jsx("div",{className:"fixed top-0 left-0 w-full h-full flex items-center justify-center bg-black bg-opacity-50 z-50",children:n.jsxs("div",{className:"bg-gray-200 text-lg rounded-lg overflow-hidden shadow-xl w-112 max-h-full overflow-y-auto",children:[n.jsxs("div",{className:"p-6",children:[n.jsx("h2",{className:"text-2xl font-bold mb-4",children:j("Select Favourites")}),n.jsx("hr",{className:"border border-black m-1"}),n.jsxs("div",{className:"mb-3 grid grid-cols-3 gap-4",children:[n.jsx("h3",{className:"font-bold mb-2 col-span-3 underline",children:j("Sports")}),d&&n.jsx("p",{children:"Loading..."}),u.slice(0,12).map(o=>n.jsxs("label",{className:"block",children:[n.jsx("input",{type:"checkbox",name:"sport",value:o.name,checked:s.includes(o.name),onChange:w,className:"mr-2"}),j(`${o.name}`)]},o.id))]}),n.jsxs("div",{className:"grid grid-cols-3 gap-3",children:[n.jsx("h3",{className:"font-bold mb-2 col-span-3 underline",children:j("Teams")}),d&&n.jsx("p",{children:"Loading..."}),l.slice(0,12).map(o=>n.jsxs("label",{className:"block",children:[n.jsx("input",{type:"checkbox",name:"team",value:o.name,checked:t.includes(o.name),onChange:w,className:"mr-2"}),o.name]},o.id))]})]}),n.jsxs("div",{className:"flex justify-end px-6 pb-6",children:[n.jsxs("button",{onClick:S,className:"bg-blue-500 text-white px-4 py-2 font-semibold rounded-md mr-2 hover:bg-blue-700 focus:outline-none focus:ring focus:border-blue-300",children:["Save ",j("Preferences")]}),n.jsx("button",{onClick:L,className:"bg-gray-300 text-gray-800 px-4 py-2 font-semibold rounded-md hover:bg-gray-400 focus:outline-none focus:ring focus:border-gray-300",children:"Close"})]})]})})})},Z=()=>{const[s,e]=c.useState(!1);return c.useEffect(()=>{const t=localStorage.getItem("authToken");e(!!t)},[]),s},ee=()=>{const{i18n:s}=E(),[e,t]=c.useState(!1),[i,u]=c.useState(!1),a=Z(),{t:l}=E();c.useEffect(()=>{const d=localStorage.getItem("language");d&&s.changeLanguage(d)},[s]);const N=()=>{t(!e)},x=()=>{u(!i)},r=d=>{s.changeLanguage(d),localStorage.setItem("language",d)};return n.jsxs("nav",{className:"bg-gray-800 px-2 py-2",children:[n.jsxs("div",{className:"flex justify-between items-center",children:[n.jsx("div",{className:"flex flex-wrap justify-center items-center",children:n.jsx(y,{to:"/",className:"flex items-center text-white text-3xl font-bold px-2",children:"Sports Live"})}),n.jsxs("div",{className:"flex flex-wrap space-x-4 text-white text-lg items-center",children:[a&&n.jsx("button",{onClick:x,className:"text-white hover:bg-gray-700 px-3 py-2 rounded-md focus:outline-none group-hover:bg-gray-700",children:l("Preferences")}),n.jsx(y,{to:"/home",children:l("Home")}),n.jsx(y,{to:"/articles",children:l("Articles")}),n.jsx(y,{to:"/matches",children:l("Matches")}),n.jsx(y,{to:"/teams",children:l("Teams")}),n.jsxs("div",{className:"relative inline-block group",children:[n.jsx("button",{onClick:N,onBlur:()=>t(!1),className:`text-white hover:bg-gray-700 px-3 py-2 rounded-md focus:outline-none group-hover:bg-gray-700 ${e?"focus:ring focus:ring-gray-400":""}`,children:n.jsx("span",{children:"⌔"})}),n.jsx("div",{className:`origin-top-right absolute right-0 mt-2 w-48 rounded-md shadow-lg bg-white ring-1 ring-black ring-opacity-5 focus:outline-none transition-all duration-300 ${e?"opacity-100 scale-100":"opacity-0 scale-95"}`,children:n.jsxs("div",{className:"py-1 font-semibold",children:[a?n.jsxs(n.Fragment,{children:[n.jsx(y,{to:"/user",className:"block px-4 py-2 text-sm text-gray-700 hover:bg-gray-100",children:l("My Profile")}),n.jsx("hr",{}),n.jsx(y,{to:"/logout",className:"block px-4 py-2 text-sm text-gray-700 hover:bg-gray-100 focus:outline-none",children:"Logout"})]}):n.jsxs(n.Fragment,{children:[n.jsx(y,{to:"/signup",className:"block px-4 py-2 text-sm text-gray-700 hover:bg-gray-100",children:l("Sign Up")}),n.jsx(y,{to:"/signin",className:"block px-4 py-2 text-sm text-gray-700 hover:bg-gray-100",children:l("Sign In")})]}),n.jsxs("div",{className:"py-1",children:[n.jsx("button",{onClick:()=>r("en"),className:"block w-full px-4 py-2 text-left text-sm text-gray-700 hover:bg-gray-100",children:"English"}),n.jsx("button",{onClick:()=>r("es"),className:"block w-full px-4 py-2 text-left text-sm text-gray-700 hover:bg-gray-100",children:"Español"})]})]})})]})]})]}),i&&n.jsx(X,{})]})};export{ee as N,E as a,Z as b,Q as u};
